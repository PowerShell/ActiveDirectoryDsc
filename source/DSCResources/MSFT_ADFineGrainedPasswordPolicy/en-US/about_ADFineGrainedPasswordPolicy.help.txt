.NAME
    ADFineGrainedPasswordPolicy

.DESCRIPTION
    The ADFineGrainedPasswordPolicy DSC resource will manage an Active Directory domain fine grained password policy.

    ## Requirements

    * Target machine must be running Windows Server 2008 R2 or later.

.PARAMETER Name
    Key - String
    Specifies an Active Directory fine-grained password policy object name.

.PARAMETER DisplayName
    Write - String
    Specifies the display name of the object.

.PARAMETER Subjects
    Write - String[]
    The ADPrinciple names the policy is to be applied to, overwrites all existing and overrides SubjectsToInclude and SubjectsToExclude.

.PARAMETER SubjectsToInclude
    Write - String[]
    The ADPrinciple names to add to the policy, does not overwrite.

.PARAMETER SubjectsToExclude
    Write - String[]
    The ADPrinciple names to remove from the policy, does not overwrite.

.PARAMETER Ensure
    Write - String
    Allowed values: Present, Absent
    Specifies whether the fine-grained password policy should be present or absent. Default value is 'Present'.

.PARAMETER ComplexityEnabled
    Write - Boolean
    Specifies whether password complexity is enabled for the password policy.

.PARAMETER LockoutDuration
    Write - String
    Specifies the length of time that an account is locked after the number of failed login attempts exceeds the lockout threshold (timespan minutes).

.PARAMETER LockoutObservationWindow
    Write - String
    Specifies the maximum time interval between two unsuccessful login attempts before the number of unsuccessful login attempts is reset to 0 (timespan minutes).

.PARAMETER LockoutThreshold
    Write - UInt32
    Specifies the number of unsuccessful login attempts that are permitted before an account is locked out.

.PARAMETER MinPasswordAge
    Write - String
    Specifies the minimum length of time before you can change a password (timespan days).

.PARAMETER MaxPasswordAge
    Write - String
    Specifies the maximum length of time that you can have the same password (timespan days).

.PARAMETER MinPasswordLength
    Write - UInt32
    Specifies the minimum number of characters that a password must contain.

.PARAMETER PasswordHistoryCount
    Write - UInt32
    Specifies the number of previous passwords to save.

.PARAMETER ReversibleEncryptionEnabled
    Write - Boolean
    Specifies whether the directory must store passwords using reversible encryption.

.PARAMETER ProtectedFromAccidentalDeletion
    Write - Boolean
    Specifies whether to prevent the object from being deleted.

.PARAMETER Precedence
    Required - UInt32
    Specifies a value that defines the precedence of a fine-grained password policy among all fine-grained password policies.

.PARAMETER DomainController
    Write - String
    Specifies the Active Directory Domain Services instance to connect to.

.PARAMETER Credential
    Write - PSCredential
    Specifies the user account credentials to use to perform this task.

.EXAMPLE 1

This configuration will create an Active Directory domain fine-grained password
policy with default settings.

Configuration ADFineGrainedPasswordPolicy_ConfigureFineGrainedPasswordPolicyWithDefaults_Config
{
    Param
    (
        [Parameter(Mandatory = $true)]
        [System.String]
        $Name,

        [Parameter(Mandatory = $true)]
        [System.UInt32]
        $Precedence
    )

    Import-DscResource -Module ActiveDirectoryDsc

    Node localhost
    {
        ADFineGrainedPasswordPolicy 'FineGrainedPasswordPolicy'
        {
            Name       = $Name
            Precedence = $Precedence
        }
    }
}

.EXAMPLE 2

This configuration will create an Active Directory domain fine-grained password
policy with specific settings settings.

Configuration ADFineGrainedPasswordPolicy_ConfigureFineGrainedPasswordPolicyWithSpecifics_Config
{
    Param
    (
        [Parameter(Mandatory = $true)]
        [System.String]
        $Name,

        [Parameter()]
        [System.String]
        $DisplayName,

        [Parameter()]
        [System.String[]]
        $Subjects,

        [Parameter()]
        [System.Boolean]
        $ComplexityEnabled,

        [Parameter()]
        [String]
        $LockoutDuration,

        [Parameter()]
        [String]
        $LockoutObservationWindow,

        [Parameter()]
        [System.UInt32]
        $LockoutThreshold,

        [Parameter()]
        [String]
        $MinPasswordAge,

        [Parameter()]
        [String]
        $MaxPasswordAge,

        [Parameter()]
        [System.UInt32]
        $MinPasswordLength,

        [Parameter()]
        [System.UInt32]
        $PasswordHistoryCount,

        [Parameter()]
        [System.Boolean]
        $ReversibleEncryptionEnabled,

        [Parameter()]
        [System.Boolean]
        $ProtectedFromAccidentalDeletion,

        [Parameter(Mandatory = $true)]
        [System.UInt32]
        $Precedence
    )

    Import-DscResource -Module ActiveDirectoryDsc

    Node localhost
    {
        ADFineGrainedPasswordPolicy 'FineGrainedPasswordPolicy'
        {
            Name                            = $Name
            DisplayName                     = $DisplayName
            Subjects                        = $Subjects
            ComplexityEnabled               = $ComplexityEnabled
            LockoutDuration                 = $LockoutDuration
            LockoutObservationWindow        = $LockoutObservationWindow
            LockoutThreshold                = $LockoutThreshold
            MaxPasswordAge                  = $MaxPasswordAge
            MinPasswordAge                  = $MinPasswordAge
            MinPasswordLength               = $MinPasswordLength
            PasswordHistoryCount            = $PasswordHistoryCount
            ReversibleEncryptionEnabled     = $ReversibleEncryptionEnabled
            ProtectedFromAccidentalDeletion = $ProtectedFromAccidentalDeletion
            Precedence                      = $Precedence
        }
    }
}

.EXAMPLE 3

This configuration will remove an Active Directory domain fine-grained password policy.

Configuration ADFineGrainedPasswordPolicy_RemoveFineGrainedPasswordPolicy_Config
{
    Param
    (
        [Parameter(Mandatory = $true)]
        [System.String]
        $Name,

        [Parameter(Mandatory = $true)]
        [System.UInt32]
        $Precedence,

        [Parameter()]
        [System.String]
        $Ensure = 'Absent'
    )

    Import-DscResource -Module ActiveDirectoryDsc

    Node localhost
    {
        ADFineGrainedPasswordPolicy 'FineGrainedPasswordPolicy'
        {
            Name       = $Name
            Precedence = $Precedence
            Ensure     = $Ensure
        }
    }
}


